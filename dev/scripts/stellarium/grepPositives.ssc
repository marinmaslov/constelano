// Name: Grep Positive Images
// License: MIT License
// Author: marinmaslov
// Last Modified: 2022/04/16
// Description: Use RA/DEC coordinates to take screenshots of ROI

// EQ COORDINATES
// RA coordinates (decimal) [right-left]
const RA_TARGET_START = 326.31;
const RA_TARGET_END = 31.31;

// DEC coordinates (decimal) [up-down]
const DEC_TARGET_START = 6.304111;
const DEC_TARGET_END = 42.43369;

LabelMgr.labelScreen("Taking shoots'.", 200, 200, true, 20, "#ff0000");
core.wait(2);
LabelMgr.deleteAllLabels();
StelMovementMgr.zoomTo(55.0, 1);
StelSkyDrawer.setFlagStarMagnitudeLimit(true);
StelSkyDrawer.setCustomStarMagnitudeLimit(6.5);
core.setGuiVisible(false);
core.setProjectionMode("ProjectionPerspective");
core.wait(3);

//Movement code
LabelMgr.deleteAllLabels();
LabelMgr.labelScreen("Capturing sample images.", 200, 200, true, 20, "#ff0000");
core.wait(2);
LabelMgr.deleteAllLabels();
core.wait(2);

var targetRadiusCheck = StelMovementMgr.getCurrentFov() / 2;



for (var i = DEC_TARGET_START; i <= DEC_TARGET_END; i=i+5.0) {
	if ((i > 0 && ((i + targetRadiusCheck >= DEC_TARGET_END) && (i - targetRadiusCheck <= DEC_TARGET_START))) || (i < 0 && ((i - targetRadiusCheck <= DEC_TARGET_START) && (i + targetRadiusCheck >= DEC_TARGET_END)))) {
		if (RA_TARGET_START < RA_TARGET_END) {
			for (var j = RA_TARGET_START; j <= RA_TARGET_END; j=j+0.5) {
				core.moveToRaDec(j, i, 0);
				core.screenshot("target_", false, "C:/Users/easmsma/Desktop/data/andromeda/positive/", false, "jpg");
				core.wait(0.5);
			}
			core.wait(1);
		}
		else {
			for (var j = RA_TARGET_START; j <= 360.0; j=j+5.0) {
				if ((targetRadiusCheck - 360 - j <= RA_TARGET_END) && (j - targetRadiusCheck >= RA_TARGET_START)) {
					core.moveToRaDec(j, i, 0);
					core.screenshot("target_", false, "C:/Users/easmsma/Desktop/data/andromeda/positive/", false, "jpg");
					core.wait(0.5);
				} 
			}
			core.wait(0.5);
			
			for (var j = 0; j <= RA_TARGET_END; j=j+5.0) {
				if ((j + targetRadiusCheck <= RA_TARGET_END) && (360 - targetRadiusCheck + j >= RA_TARGET_START)) {
					core.moveToRaDec(j, i, 0);
					core.screenshot("target_", false, "C:/Users/easmsma/Desktop/data/andromeda/positive/", false, "jpg");
					core.wait(0.5);
				}
			}
			core.wait(0.5);
		}
	}
	core.wait(0.5);
}
core.wait(2);
core.setGuiVisible(true);